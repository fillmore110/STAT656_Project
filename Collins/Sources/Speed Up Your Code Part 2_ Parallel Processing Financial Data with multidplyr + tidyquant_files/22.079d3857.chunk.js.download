(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"1Z3a":function(e,t,n){},"2uLe":function(e,t,n){"use strict";var a=n("mj2O"),c=n.n(a),r=n("7SM1"),i=n("8Epr"),o=n("Hvhg"),s=n("ERkP"),u=n("uDfI"),l=n("vTYT"),d=n("7oto");t.a=function useSetPreviewHeight(){var e=Object(s.useRef)(null),t=Object(u.c)(function(e){return!!e.conversations.activeConversation}),n=Object(u.c)(o.b).showBranding,a=void 0!==n&&n,f=Object(i.a)().noPolicy,b=Object(u.c)(function(e){return e.session.gdpr}),m=b.hasConsent,O=b.declinedConsent,v=Object(s.useCallback)(function(){var e=0,t=!a&&f;return O&&(e+=40),t&&(e+=18),m||(e+=t?14:7),e},[O,m,f,a]),j=Object(s.useCallback)(function(){return e.current?e.current.clientHeight:200},[e]),g=Object(s.useCallback)(function(){var e=Object(r.a)(c.a.mark(function _callee(e){var n,a,r,i,o=arguments;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],!t||!m){c.next=3;break}return c.abrupt("return");case 3:a=v(),r=j(),i=e?"".concat(r+155-a,"px"):"0px",Object(d.a)({topic:"set-frame-height",message:{height:i,name:l.b.CHAT,transition:!0,transitionHeight:n}});case 7:case"end":return c.stop()}},_callee)}));return function(t){return e.apply(this,arguments)}}(),[t,m,v,j]),p=Object(s.useCallback)(Object(r.a)(c.a.mark(function _callee2(){var e;return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:e=j(),Object(d.a)({topic:"set-frame-height",message:{height:"".concat(e+80,"px"),name:l.b.SLIDER,transition:!0,transitionHeight:!1}});case 2:case"end":return t.stop()}},_callee2)})),[j]),h=Object(s.useCallback)(Object(r.a)(c.a.mark(function _callee3(){var e;return c.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:e=j(),Object(d.a)({topic:"set-frame-height",message:{height:"".concat(e+35,"px"),name:l.b.EMAIL_CAPTURE,transition:!0,transitionHeight:!1}});case 2:case"end":return t.stop()}},_callee3)})),[j]);return{previewRef:e,setChatHeight:g,setSliderHeight:p,setEmailCaptureHeight:h}}},"9Hpm":function(e,t,n){},G5CQ:function(e,t,n){},Ldxc:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return f});var a=n("mj2O"),c=n.n(a),r=n("7SM1"),i=n("SsZN"),o=n("vjCh"),s=n("qixE"),u=n("6lNa"),l=n("0lfv"),d=function(){var e=Object(r.a)(c.a.mark(function _callee(e,t){return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:try{Object(o.j)(t.id,t.playbookId),Object(s.a)(u.b.SUBMITTED),Object(s.a)(u.b.LEAD_CAPTURED,{email:e})}catch(a){Object(l.v)(["Failed to capture lead for email announcement playbook",a])}case 1:case"end":return n.stop()}},_callee)}));return function captureLeadForEmailAnnouncementPlaybook(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:try{Object(o.j)(e.id,e.playbookId),Object(i.c)(u.b.CLICKED,e.id),Object(s.a)(u.b.CLICKED)}catch(n){Object(l.v)(["Failed to capture CTA click for takeover playbook",n])}case 1:case"end":return t.stop()}},_callee2)}));return function captureCTAClickForAnnouncementPlaybook(t){return e.apply(this,arguments)}}()},MWt3:function(e,t,n){},SrLZ:function(e,t,n){"use strict";n.r(t);var a,c=n("mj2O"),r=n.n(c),i=n("7SM1"),o=n("s8DI"),s=n("OE2q"),u=n("mssF"),l=n("O94r"),d=n.n(l),f=n("Rqwx"),b=n("fTFZ"),m=n("vkRn"),O=n("CwrG"),v=n("HXmn"),j=n("8eKL"),g=n("slYP"),p=n("BY8A"),h=n("+/Je"),E=n("fw6E"),w=n("1b8i"),C=n("fpJs"),y=n("6wvX"),k=n("Sn8X"),_=n("fJrp"),T=n("8Epr"),N=n("lE29"),I=n("swFs"),S=n("+Kbs"),L=n("nQD+"),x=n("jm9a"),A=n("efbE"),H=function recordConsent(e,t){return A.e.post("/end_users/".concat(e,"/consent"),{consentId:"has_consent",message:t})},M=n("Ztgx"),R=n("NJA7"),F=n("TDUE"),D=n("ERkP"),P=n.n(D),B=n("uDfI"),U=n("gG69"),G=function useTrackImpressionOnce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U.c.LIVE_CHAT,t=Object(D.useState)(!1),n=Object(o.a)(t,2),a=n[0],c=n[1],s=Object(B.c)(function(e){return e.view}).chatOpen;Object(D.useEffect)(function(){!function(){var t=Object(i.a)(r.a.mark(function _callee(){var t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(!s||a){n.next=5;break}return n.next=3,Object(F.d)(e);case 3:t=n.sent,c(t);case 5:case"end":return n.stop()}},_callee)}));return function trackImpression(){return t.apply(this,arguments)}}()()},[a,s,e])},V=n("qixE"),Z=n("SFoa"),K=n("qwiD"),$=n("LVcX"),J=n("SWQ0"),Y=n("0lfv"),W=n("Nlet"),X=n("wNJw"),q=(n("sZBt"),function DeclinedConsent(e){var t=e.consentMessage;return P.a.createElement("div",{className:"drift-widget-greeting-content"},P.a.createElement("p",{className:"drift-widget-gdpr-consent--copy"},t))}),z=function InquireConsent(e){var t=e.message,n=e.onConsentButtonClicked,a=e.yesConsentLabel,c=e.noConsentLabel;return P.a.createElement(P.a.Fragment,null,P.a.createElement("div",{className:"drift-widget-greeting-content"},P.a.createElement("p",{className:"drift-widget-gdpr-consent--copy"},t)),P.a.createElement("div",{className:"drift-gdpr-actions"},P.a.createElement(R.a,{className:"drift-gdpr-action--allow-consent",onClick:n(!0)},P.a.createElement("span",{className:"drift-gdpr-action--text"},a)),P.a.createElement(R.a,{className:"drift-gdpr-action--deny-consent",onClick:n(!1)},P.a.createElement("span",{className:"drift-gdpr-action--text"},c))))},Q=function GDPR(e){var t=e.previewRef,n=e.resetChatHeight,a=Object(B.b)(),c=Object(B.c)(function(e){return e.embed.configuration.dataProtection}),o=c.policies,s=c.default,u=Object(B.c)(function(e){return e.embed.configuration}).team,l=void 0===u?[]:u,d=Object(B.c)(function(e){return e.session}),f=d.endUser,b=d.gdpr,m=(void 0===b?{}:b).declinedConsent;Object(D.useLayoutEffect)(function(){m&&n()},[m,n]);var O=Object(W.c)().locale,v=Object(Z.h)()?Object(Z.e)():O,j=Object(D.useMemo)(function(){return l.find(function(e){return e.bot})||{}},[l]),g=Object(D.useMemo)(function(){var e=Object($.a)(null,[v],o);if(e)return e;var t=Object($.a)(null,["".concat(s)],o);return t||(Object(Y.n)({data:["No locale matched and unable to find default policy: ".concat(t)]}),null)},[v,o,s]);if(G(U.c.GDPR),!g)return null;return P.a.createElement("div",{className:"drift-widget-gdpr-consent drift-widget-greeting"},P.a.createElement(M.a,{messageText:"Data Privacy Bot",senderIds:[j.id]}),P.a.createElement("div",{ref:t,className:"drift-widget-gdpr-body"},!m&&P.a.createElement(z,{message:g.message,onConsentButtonClicked:function doRecordConsent(e){return Object(i.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,Object(X.a)(J.b.GDPR_CLICKED,{accepted:e,endUser:f.id}),!e){t.next=5;break}return t.next=5,H(f.id,g.message);case 5:a(Object(K.o)({hasConsent:e})),e||(a(Object(K.c)(!0)),Object(V.b)()),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn(t.t0);case 12:case"end":return t.stop()}},_callee,null,[[0,9]])}))},yesConsentLabel:g.giveConsentLabel,noConsentLabel:g.declineConsentLabel}),m&&P.a.createElement(q,{consentMessage:g.consentDeclinedMessage})))},ee=n("noex"),te=n("mZ4K"),ne=n("SsZN"),ae=n("g6eD"),ce=n("6lNa"),re=n("7oto"),ie=n("nedb"),oe=function createCampaignDismissedEvent(e,t){return Object(ne.c)(ce.b.CLICKED,t.id),"number"!==typeof e?null:Object(V.a)(ce.b.DISMISSED,{conversationId:e})},se=function useCloseChat(){var e=Object(ie.a)(),t=Object(B.c)(function(e){return e.session.endUser}),n=Object(B.b)(),a=Object(D.useState)(!1),c=Object(o.a)(a,2),r=c[0],i=c[1],s=Object(B.c)(function(e){return e.view.isChatTakeover}),u=Object(B.c)(function(e){return Object($.a)(null,["view","closeChatRedirectUrl"],e)}),l=Object(B.c)(function(e){return e.conversations.activeConversation}),d=Object(B.c)(function(e){return Object($.a)(!1,["conversations","conversationStatus",l,"endUserResponded"],e)});Object(D.useEffect)(function(){r&&(n(Object(ae.c)({chatOpen:!1,isChatTakeover:!1})),i(!1))},[r,n]);var f=Object(D.useCallback)(function(){var n;if(Object(re.a)({topic:"remove-chat-takeover",message:{classNamesToRemove:["drift-frame-chat__takeover"]}}),!d){var a=[oe(l,e)];if(e&&e.id){var c={campaignId:e.id,endUserId:t.id};e.attributes.playbookId&&(c.playbookId=e.attributes.playbookId),a.push(Object(re.a)({topic:"send-usage-metric-event",message:{name:"Campaign Dismissed",attributes:c,publishImmediately:!0}}))}n=Promise.all(a)}if(u){var r=function redirect(){return Object(re.a)({topic:"redirect-to-url",message:{url:u}})};n?n.then(r):r()}},[e,l,u,t.id,d]);return Object(D.useCallback)(function closeChat(){i(!0),s&&f()},[s,f])},ue=n("58kB"),le=(n("1Z3a"),function ChatTakeover(){var e=Object(B.c)(function(e){return e.conversations.activeConversation}),t=Object(te.a)(),n=Object(ue.a)(t).recipient,a=Object(N.a)().conversationHeaderTextStyles,c=se();return P.a.createElement("div",{className:"drift-widget-active-conversation-header"},e&&P.a.createElement(P.a.Fragment,null,P.a.createElement(ee.a,{size:"SMALL",id:n.id}),P.a.createElement("h1",{className:"drift-widget-recipient-name",style:a},n.name)),P.a.createElement(L.a,{onClick:c,className:"drift-widget-chat-takeover-close-button"},P.a.createElement(S.j,{width:16,height:16})))}),de=n("nJ3u"),fe=n("GtSE"),be=function Time(e){var t=e.height,n=void 0===t?24:t,a=e.width,c=void 0===a?24:a,r=e.fill,i=void 0===r?"#FFF":r;return P.a.createElement("svg",{className:"drift-default-icon drift-default-icon--Time",width:c,height:n,viewBox:"0 0 20 20"},P.a.createElement("path",{d:"M3.55,10.3l.79-.78a.77.77,0,0,1,1.09,1.09L3.3,12.74a.79.79,0,0,1-1.11,0l-2-2.13A.77.77,0,1,1,1.33,9.54l.69.73V10a9,9,0,1,1,3.07,6.77.77.77,0,1,1,1-1.16A7.45,7.45,0,1,0,3.56,10C3.56,10.08,3.56,10.18,3.55,10.3Zm7.72-4.93v4.87h3.34a.77.77,0,0,1,0,1.54H10.5A.76.76,0,0,1,9.73,11V5.37a.77.77,0,0,1,1.54,0Z",fill:i}))},me=n("z24s"),Oe=n("Tr4L"),ve=(n("9Hpm"),function ConversationHeader(){var e=Object(D.useRef)(null),t=Object(me.a)(e),n=Object(Oe.a)().t,a=Object(te.a)(),c=Object(ue.a)(a).recipient,r=Object(B.c)(function(e){return e.conversations.conversations}),i=Object(N.a)(),o=i.backgroundStyles,s=i.conversationHeaderTextStyles,u=i.widgetSecondaryColor,l=Object(y.a)(),f=Object(E.a)(),b=f.conversationHistoryEnabled,m=f.conversationHistoryOpen,O=f.onToggleConversationHistory,v=b&&!m&&Object.keys(r).length>1,j=Object(D.useRef)(),g=Object(me.a)(j);return Object(D.useEffect)(function(){j.current&&j.current.focus()},[m]),P.a.createElement("div",{className:"drift-widget-active-conversation-header"},P.a.createElement(ee.a,{size:"SMALL",id:c.id}),P.a.createElement("h1",{"aria-hidden":m,className:"drift-widget-recipient-name",style:s},c.name),P.a.createElement("div",{className:d()("drift-widget-conversation-history-header",{"drift-widget-conversation-history-header--open":m}),style:o,"aria-hidden":!m},P.a.createElement("style",null,"\n            .drift-widget-history-back-button.keyboard-focused svg {\n              ".concat(Object(de.d)(o.background.toString().replace("#",""),u.replace("#","")),"\n            }\n          ")),P.a.createElement(L.a,{ref:j,className:d()("drift-widget-history-back-button",{"keyboard-focused":g}),onClick:function onClick(){return O(!m)},"aria-label":"Back to conversation",disabled:!m},P.a.createElement(fe.a,{color:u,width:20,height:20})),P.a.createElement("h1",{style:s},n("history.headerTitle"))),v&&P.a.createElement(P.a.Fragment,null,P.a.createElement("style",null,"\n              .drift-widget-history.keyboard-focused {\n                ".concat(Object(de.b)(u.replace("#","")),"\n              }\n            ")),P.a.createElement(L.a,{className:d()("drift-widget-history",{"drift-widget-history--mobile":l,"drift-widget-history--open":m,"keyboard-focused":t}),"aria-label":"Open conversation history",disabled:m,onClick:function onClick(){return O(!m)},ref:e},P.a.createElement(be,{fill:u,height:20,width:20}))))}),je=n("NFvl"),ge=function useDefaultGreeting(){var e=Object(Oe.a)().t,t=Object(B.c)(function(t){var n=Object(je.a)(["embed","configuration","theme","welcomeMessage"],t);return n||e("greeting.onlineMessage")}),n=Object(B.c)(function(e){return e.view.matchedHours}),a=Object(B.c)(function(t){var n=Object(je.a)(["embed","configuration","theme","awayMessage"],t);return n||e("greeting.awayMessage")});return n?t:a},pe=n("hm8b"),he=(n("txDs"),function GreetingMessage(e){var t=e.previewRef,n=ge(),a=Object(te.b)(),c=Object(B.c)(function(e){return e.view}).chatOpen,r=Object(_.a)(c),i=Object(B.c)(function(e){return e.view.matchedHours});Object(D.useEffect)(function(){Object(pe.a)(r)||c===r||(i?Object(ne.s)(c):Object(ne.a)(c))},[r,c,i]);var o=a.length>1;return G(),P.a.createElement("div",{className:d()("drift-widget-greeting",{"greeting-multiple-senders":o})},P.a.createElement(M.a,{senderIds:a}),P.a.createElement("p",{ref:t,className:"drift-widget-greeting-content"},n))}),Ee=n("xyhj"),we=n("hSLT"),Ce=n("Wjfv"),ye=n("Ldxc"),ke=n("PjZB"),_e=(n("Uo75"),function WelcomeMessage(e){var t=e.previewRef,n=Object(B.b)(),a=Object(B.c)(function(e){return e.view}).chatOpen,c=Object(te.b)(),o=Object(we.a)();if(!a)return null;var s=function(){var e=Object(i.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:Object(ye.a)(o),n(Object(Ce.a)()),o.ctaType===ke.a.LINK_TO_URL&&n(Object(ae.c)({chatOpen:!1}));case 3:case"end":return e.stop()}},_callee)}));return function onCtaClicked(){return e.apply(this,arguments)}}();return P.a.createElement("div",{className:"drift-widget-greeting"},P.a.createElement(M.a,{senderIds:c}),P.a.createElement("div",{ref:t,className:"drift-widget-welcome-message-content"},P.a.createElement("div",{dangerouslySetInnerHTML:{__html:'\n              <div class="drift-welcome-message-content--body">\n                '.concat(o.body,"\n              </div>\n            ")}})),o.ctaCopy&&o.ctaType!==ke.a.CHAT_RESPONSE&&P.a.createElement("div",{className:"drift-widget-greeting-cta-wrapper"},P.a.createElement(Ee.a,{ctaUrl:o.ctaUrl,ctaType:o.ctaType,ctaCopy:o.ctaCopy,onClick:s})))}),Te="GREETING",Ne="CHAT_TAKEOVER",Ie="CONVERSATION",Se="GDPR",Le="WELCOME_MESSAGE",xe=(a={},Object(x.a)(a,Le,function(e){return P.a.createElement(_e,e)}),Object(x.a)(a,Te,function(e){return P.a.createElement(he,e)}),Object(x.a)(a,Ie,function(e){return P.a.createElement(ve,e)}),Object(x.a)(a,Se,function(e){return P.a.createElement(Q,e)}),Object(x.a)(a,Ne,function(e){return P.a.createElement(le,e)}),a),Ae=n("2uLe"),He=(n("SwvN"),function HeaderLayout(e){var t=e.activeConversation,n=e.chatHidden,a=e.isChatTakeover,c=void 0!==a&&a,r=Object(B.b)(),i=Object(N.a)(),s=i.backgroundStyles,u=i.conversationHeaderTextStyles,l=Object(B.c)(function(e){return e.campaigns.activeCampaign}).id,f=Object(B.c)(function(e){return e.session.gdpr}).hasConsent,b=Object(y.a)(),m=Object(Ae.a)(),O=m.setChatHeight,v=m.previewRef,j=Object(B.c)(function(e){return e.view}).chatOpen,g=Object(D.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;return f?c?Ne:e?Ie:l?Le:Te:Se},[t,f,c,l]),p=Object(D.useState)(g()),h=Object(o.a)(p,2),E=h[0],w=h[1],C=Object(_.a)(E),k=E!==C;Object(D.useLayoutEffect)(function(){j&&!n&&O(j,k)},[j,n,O,k]),Object(D.useEffect)(function(){var e=g(t);e!==E&&w(e)},[t,l,f,g,E]);var T=xe[E],x=E!==Ie,A=b&&!c;return P.a.createElement("header",{className:d()("drift-widget-header",{"drift-widget-header--collapsed":x,"drift-widget-header--gdpr-consent":!f})},P.a.createElement(I.a,{style:s}),P.a.createElement("div",{className:"drift-widget-header--content"},P.a.createElement(T,{previewRef:v,resetChatHeight:function resetChatHeight(){O(j,!0)}})),A&&P.a.createElement(L.a,{onClick:function doToggleChat(){r(Object(ae.c)({chatOpen:!1}))},className:"drift-widget-mobile-close","aria-label":"Close chat",style:u},P.a.createElement(S.j,{width:16,height:16})))}),Me=n("vjCh"),Re=n("K7i0"),Fe=n("bYXQ"),De=n("Hvhg"),Pe=n("da4L"),Be=n("Gxm1"),Ue=n("TbSn"),Ge=n("kNJ0"),Ve=n("oPI6"),Ze=n("MFhO"),Ke=n("VpmR"),$e=n("4c+F"),Je=n("HSQL"),Ye=(n("sXTY"),null),We=function ChatLayout(){var e=Object(B.b)(),t=Object(y.a)(),n=Object(D.useState)(!0),a=Object(o.a)(n,2),c=a[0],l=a[1];Object(k.a)();var f=Object(B.c)(function(e){return e.view}),I=f.chatOpen,S=f.isChatTakeover,L=Object(B.c)(De.b).showBranding,x=void 0!==L&&L,A=Object(T.a)().noPolicy,H=!x&&A;Object(D.useLayoutEffect)(function(){S&&I&&Object(re.a)({topic:"set-frame-width-and-height",message:{className:"drift-frame-chat__takeover",height:"100%",max:!0,name:"chat",width:"100%"}})},[S,I]);var M=Object(B.c)(function(e){return e.conversations.activeConversation}),R=Object(_.a)(M),F=Object(B.c)(function(e){return e.conversations.conversations}),U=Object(B.c)(function(e){return e.conversations.messages}),G=Object(B.c)(function(e){return Object($.a)({},["conversations","messages",e.conversations.activeConversation],e)}),V=Object(B.c)(function(e){return Object($.a)(!1,["conversations","conversationStatus",e.conversations.activeConversation,"permaclosed"],e)}),Z=Object(D.useMemo)(function(){return Object(Pe.n)(G)},[G]),K=Object(B.c)(function(e){return e.campaigns.activeCampaign}),J=Object(D.useMemo)(function(){return Object($.a)(null,["attributes","campaignDisplayType"],K)===Ze.a.WELCOME_MESSAGE},[K]),W=Object(B.c)(function(e){return e.session.gdpr}).hasConsent,X=Object(B.c)(function(e){return Object($.a)(!1,["conversations","conversationStatus",M,"endUserResponded"],e)}),q=Object(E.a)(),z=q.conversationHistoryOpen,Q=q.conversationHistoryEnabled,ee=Object(N.a)().widgetBackgroundStyles,te=Object(D.useCallback)(function(){var t=Object(i.a)(r.a.mark(function _callee(t){var n,a,c,i,o,s;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.limit,a=void 0===n?30:n,c=t.from,i=void 0===c?null:c,M&&M!==h.a){r.next=3;break}return r.abrupt("return");case 3:return r.prev=3,r.next=6,Object(u.d)({conversationId:M,limit:a,from:i});case 6:return o=r.sent,s=o.data,e(Object(Re.j)({messages:s.data,hasMoreMessages:Object($.a)(!1,["pagination","more"],s),nextPageMessageId:Object($.a)(null,["pagination","next"],s),conversationId:M})),r.abrupt("return",s);case 12:r.prev=12,r.t0=r.catch(3),Object(Y.f)("Failed to fetch messages",r.t0);case 15:case"end":return r.stop()}},_callee,null,[[3,12]])}));return function(e){return t.apply(this,arguments)}}(),[M,e]);Object(D.useEffect)(function(){(function(){var t=Object(i.a)(r.a.mark(function _callee2(){var t,n,a,c,i;return r.a.wrap(function _callee2$(r){for(;;)switch(r.prev=r.next){case 0:if(t=!M||M===h.a,n=R===M,a=!!F[M]&&!!U[M],!(t||n||a||Object(Fe.c)(M))){r.next=5;break}return r.abrupt("return");case 5:return r.prev=5,r.next=8,Object(s.h)(M);case 8:c=r.sent,i=c.data,e(Object(Re.h)({conversation:i})),te({}),r.next=17;break;case 14:r.prev=14,r.t0=r.catch(5),Object(Y.f)("Failed to fetch messages or active conversation",r.t0);case 17:case"end":return r.stop()}},_callee2,null,[[5,14]])}));return function fetchInfoForActiveConversation(){return t.apply(this,arguments)}})()()},[M,e,te,R,F,U]),Object(D.useEffect)(function(){I?(function(){var e=Object(i.a)(r.a.mark(function _callee3(){return r.a.wrap(function _callee3$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(re.a)({topic:"focus-frame",message:{name:"chat"}});case 2:case"end":return e.stop()}},_callee3)}));return function focus(){return e.apply(this,arguments)}}()(),Ye&&clearTimeout(Ye),l(!1)):Ye=setTimeout(function delaySetReflowHidden(){l(!0)},350)},[I]);var ae=Object(D.useMemo)(function(){if(!W||!I)return!1;if(K&&K.id&&!M){var e=!!Object($.a)(null,["attributes","cta"],K),t="CHAT_RESPONSE"!==Object($.a)(null,["attributes","cta","CtaType"],K);if(e&&t)return!1}var n=Z.length>0&&Z.length<=2&&!Object(Pe.f)(Z[0]);return!S||n||Z.length>2},[K,M,W,S,Z,I]);Object(D.useEffect)(function(){Object(Je.b)("WIDGET_CHAT_FRAME.start")},[]);var ie=Object(D.useRef)(!1);Object(D.useEffect)(function(){if(!ie.current&&S&&Z.length>0){var e=Object(Be.b)("post_form_takeover_tti"),t=Object(Be.b)("post_form_takeover_show");e&&Object($e.d)("Post Form Takeover TTI",e),t&&Object($e.d)("Post Form Takeover Show",t),ie.current=!0}},[S,Z]);var oe=Object(D.useMemo)(function(){if(V)return b.a.UNAVAILABLE;var e=Object(Ue.a)(Z);if(!e)return b.a.AVAILABLE;var t=Object(Ge.a)(-2,Z),n=Object(Pe.f)(t)&&Object(Pe.h)(e);return Object(Pe.f)(e)||n||Object(Pe.i)(e)?b.a.UNAVAILABLE_BUTTONS:Object(Pe.k)(e)||Object(Pe.k)(t)&&Object(Pe.h)(e)?b.a.AVAILABLE_BUTTONS:b.a.AVAILABLE},[Z,V]),se=oe===b.a.AVAILABLE||oe===b.a.AVAILABLE_BUTTONS,ue=Object(w.a)(Z,M),le=Object(D.useMemo)(function(){return Object(Pe.d)(ue)},[ue]),de=Object(D.useMemo)(function(){return P.a.createElement(j.a,{activeConversation:M,messageGroups:le,messages:ue,fetchMessages:te,reflowHidden:c,disabled:z})},[M,le,ue,te,c,z]),fe=Object(C.a)(),be=Object(D.useMemo)(function(){if(ue&&ue.length){var e=Object(Ue.a)(ue);if(e&&Object(Pe.j)(e))return e}return null},[ue]),me=W&&(!!M||S),Oe=!ae||!se;return P.a.createElement("main",{className:d()("drift-widget-chat-layout",{"drift-widget-chat-layout__takeover":S&&!t,"drift-widget-chat-layout__takeover--noResponse":S&&!t&&!X}),role:"main","aria-label":"Chat window"},P.a.createElement(p.a,null),P.a.createElement("div",{className:d()("drift-widget-chat-wrapper",{"drift-widget-chat-wrapper__open":I,"drift-widget-chat-wrapper__closed":!I,"drift-widget-chat-wrapper__reflow-hidden":c,"drift-widget-chat-wrapper__active-conversation":me,"drift-widget-chat-wrapper__no-footer-content":H&&Oe})},P.a.createElement(He,{activeConversation:M,chatHidden:c,isChatTakeover:S}),!S&&Q&&P.a.createElement(m.a,null),me&&P.a.createElement("div",{className:d()("drift-widget-message-history",{"drift-widget-message-history--with-footer":fe,"drift-widget-message-history--no-composer":Oe}),style:ee},de,0===Z.length&&P.a.createElement(v.a,null)),P.a.createElement("div",{className:"drift-widget-chat-bottom"},ae&&P.a.createElement(b.b,{state:oe,disabled:z,onSubmit:function doSendMessage(t){if((J||S)&&!M){var n=Object($.a)(null,["attributes","playbookId"],K);!function sendSubmittedEventForChatResponseCampaign(){K&&"CHAT_RESPONSE"===Object($.a)(null,["attributes","cta","CtaType"],K)&&Object(ne.c)(ce.b.SUBMITTED,K.id)}(),Object(Me.j)(K.id,n)}e(Object(Re.m)(t))},chatHidden:c,activeConversationId:M}),P.a.createElement(O.a,null)),M&&!!be&&P.a.createElement(g.a,{message:be})))};t.default=function(e){var t=Object(D.useState)(!1),n=Object(o.a)(t,2),a=n[0],c=n[1],s=Object(B.c)(function(e){return e.view.initComplete}),u=Object(B.c)(function(e){return Object($.a)("en",["embed","configuration","locale"],e)});return Object(D.useEffect)(function(){s&&!a&&function(){var e=Object(i.a)(r.a.mark(function _callee4(){return r.a.wrap(function _callee4$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Ke.a)(u);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),Object(Y.n)({data:["i18n failed to load - ".concat(e.t0.message),e.t0],type:"warn"});case 8:c(!0);case 9:case"end":return e.stop()}},_callee4,null,[[0,5]])}));return function runAsync(){return e.apply(this,arguments)}}()()},[s,a,u]),P.a.createElement(Ve.a,null,s&&a?P.a.createElement(We,e):P.a.createElement(f.a,null))}},SwvN:function(e,t,n){},Uo75:function(e,t,n){},Ztgx:function(e,t,n){"use strict";var a=n("yEsl"),c=n("58kB"),r=n("i9gz"),i=n("weY7"),o=n("RhEL"),s=n("ERkP"),u=n.n(s),l=n("Tr4L"),d=n("uDfI"),f=n("F8vJ");n("oY6K");t.a=u.a.memo(function SenderInfo(e){var t=e.senderIds,n=e.messageText,o=void 0===n?null:n,b=Object(l.a)().t,m=Object(d.c)(function(e){return e.embed.configuration.organizationName}),O=Object(c.b)(t),v=Object(s.useMemo)(function(){var e;if(o)return o;if(t.length>1||Object(r.a)(O))return"";var n=null===(e=O[0])||void 0===e?void 0:e.recipient;if(!n||!n.name)return"";var a=!m||!m.length||Object(f.a)(m),c=!!m&&n.name.toLowerCase()===m.toLowerCase();return a||c?"".concat(n.name):b("header.senderInfo",{name:n.name,orgName:m})},[t.length,O,m,o,b]);return u.a.createElement("div",{className:"drift-widget-greeting-agent-header"},u.a.createElement("h1",{className:"drift-widget-greeting-recipient-name"},v),u.a.createElement(function Avatars(){return u.a.createElement(u.a.Fragment,null," ",Object(i.a)(function(e){return e.recipient?u.a.createElement(a.a,{key:e.recipient.id,id:e.recipient.id}):u.a.createElement(u.a.Fragment,null)},O))},null))},function propsAreEqual(e,t){return e.senderId===t.senderId&&e.messageText===t.messageText||Object(o.a)(e.senderIds,t.senderIds)&&e.messageText===t.messageText})},hSLT:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI");t.a=function useActiveAnnouncementCampaign(){var e=Object(c.c)(function(e){return Object(a.a)({},["campaigns","activeCampaign"],e)}),t=e.attributes,n=void 0===t?{}:t;return{id:e.id,playbookId:Object(a.a)(null,["playbookId"],n),ctaType:Object(a.a)(null,["cta","CtaType"],n),ctaCopy:Object(a.a)("",["cta","copy"],n),ctaUrl:Object(a.a)("",["cta","UrlLink"],n),body:n.message||"",title:n.title||"",thanksTitle:n.thankYouHeadline||"",thanksMessage:n.thankYouMessage||"",senderId:n.senderId,type:n.campaignDisplayType}}},oY6K:function(e,t,n){},sXTY:function(e,t,n){},sZBt:function(e,t,n){},swFs:function(e,t,n){"use strict";var a=n("ERkP"),c=n.n(a);n("G5CQ");t.a=function TopLine(e){var t=e.style;return c.a.createElement("div",{className:"drift-widget-header-top-line",style:t})}},txDs:function(e,t,n){},xyhj:function(e,t,n){"use strict";var a=n("nfbA"),c=n("nJ3u"),r=n("O94r"),i=n.n(r),o=n("z24s"),s=n("o3t1"),u=n("lE29"),l=n("ERkP"),d=n.n(l),f=n("uDfI"),b=n("PjZB"),m=n("7oto"),O=n("rTkt");n("MWt3");t.a=function CtaButton(e){var t=e.ctaUrl,n=e.ctaCopy,r=e.ctaType,v=e.onClick,j=e.ariaHidden,g=Object(s.a)(),p=g.hoverProps,h=g.isHovered,E=Object(u.a)(),w=E.activeColor,C=E.backgroundStyles,y=Object(f.c)(function(e){return e.campaigns.activeCampaign}),k=Object(l.useRef)(null),_=Object(o.a)(k),T=Object(l.useMemo)(function(){var e=h?Object(O.c)(C.background,-5):C.background;return Object(a.a)(Object(a.a)({},C),{},{background:e})},[C,h]),N=function onCtaClick(e){r===b.a.CHAT_RESPONSE?Object(m.a)({topic:"drift-api:open-chat"}):r===b.a.SCHEDULE_MEETING&&Object(m.a)({topic:"drift-api:schedule-meeting",message:{scheduleMeetingWith:y.attributes.senderId,options:{activeCampaign:y}}}),v&&v(e)};return Object(l.useEffect)(function(){var e=k;return setTimeout(function(){return e.current&&e.current.focus()},50),function(){return e.current&&e.current.blur()}},[]),r===b.a.LINK_TO_URL?d.a.createElement(d.a.Fragment,null,d.a.createElement("style",null,"\n            .drift-widget-announcement-cta-link-wrapper a.keyboard-focused {\n              ".concat(Object(c.d)("FFFFFF",w),"\n            }\n          ")),d.a.createElement("div",{className:"drift-widget-announcement-cta drift-widget-announcement-cta-link-wrapper",hidden:j},d.a.createElement("a",Object.assign({className:i()("drift-widget-announcement-cta-link",{"keyboard-focused":_&&!j}),href:t,onClick:N,target:"_blank",rel:"noopener noreferrer",ref:k,"aria-describedby":"drift-widget-announcement-cta-description",style:T,"aria-hidden":j},p),n),d.a.createElement("span",{hidden:!0,id:"drift-widget-announcement-cta-description"},n+"; opens an external site in a new window"))):d.a.createElement(d.a.Fragment,null,d.a.createElement("style",null,"\n          .drift-widget-announcement-cta.keyboard-focused {\n            ".concat(Object(c.d)("FFFFFF",w),"\n          }\n        ")),d.a.createElement("button",Object.assign({className:i()("drift-widget-announcement-cta",{"keyboard-focused":_}),onClick:N,style:T,ref:k},p),n))}}}]);